{
  "bash_script": "#!/usr/bin/env bash\nset -euo pipefail\n\nROOT_DIR=\"golden-go-clean\"\nmkdir -p \"$ROOT_DIR\"\ncd \"$ROOT_DIR\"\n\ngit init\ngo mod init \"github.com/acme/golden-go-clean\"\nmkdir -p \".github\"\nmkdir -p \".github/workflows\"\nmkdir -p \"cmd\"\nmkdir -p \"cmd/server\"\nmkdir -p \"db\"\nmkdir -p \"db/init\"\nmkdir -p \"docs\"\nmkdir -p \"internal\"\nmkdir -p \"internal/cache\"\nmkdir -p \"internal/config\"\nmkdir -p \"internal/db\"\nmkdir -p \"internal/delivery\"\nmkdir -p \"internal/delivery/http\"\nmkdir -p \"internal/domain\"\nmkdir -p \"internal/grpc\"\nmkdir -p \"internal/grpc/client\"\nmkdir -p \"internal/grpc/server\"\nmkdir -p \"internal/handlers\"\nmkdir -p \"internal/health\"\nmkdir -p \"internal/logger\"\nmkdir -p \"internal/messaging\"\nmkdir -p \"internal/middleware\"\nmkdir -p \"internal/models\"\nmkdir -p \"internal/repository\"\nmkdir -p \"internal/routes\"\nmkdir -p \"internal/usecase\"\nmkdir -p \"migrations\"\nmkdir -p \"proto\"\n\ncat \u003e \".env\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nPORT=8080\nDATABASE_URL=postgres://app:app@postgres:5432/app?sslmode=disable\nREDIS_ADDR=redis:6379\nKAFKA_BROKERS=kafka:9092\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \".github/workflows/ci.yaml\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nname: CI\n\non:\n  push:\n  pull_request:\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        if: hashFiles('package.json') != ''\n        with:\n          node-version: '22'\n      - uses: actions/setup-go@v5\n        if: hashFiles('go.mod') != ''\n        with:\n          go-version: '1.23'\n      - uses: actions/setup-python@v5\n        if: hashFiles('requirements.txt') != ''\n        with:\n          python-version: '3.12'\n      - run: go test ./...\n        if: hashFiles('go.mod') != ''\n      - run: npm test\n        if: hashFiles('package.json') != ''\n      - run: pytest\n        if: hashFiles('requirements.txt') != ''\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \".gitignore\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\n# StackSprint\n.env\n*.log\n.DS_Store\nbin/\ncoverage.out\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"Dockerfile\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nFROM golang:1.23-alpine AS build\nWORKDIR /app\nCOPY . .\nRUN go mod tidy \u0026\u0026 go build -o app ./cmd/server\n\nFROM alpine:3.21\nWORKDIR /app\nCOPY --from=build /app/app ./app\nEXPOSE 8080\nCMD [\"./app\"]\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"Makefile\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nup:\n\tdocker compose up --build\n\ndown:\n\tdocker compose down -v\n\ntest:\n\t@echo \"Run language-specific tests\"\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"README.md\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\n# StackSprint Generated Project\n\nLanguage: go\nFramework: fiber\nArchitecture: clean\nDatabase: postgresql\n\n## Run\n\n```bash\ndocker compose up --build\n```\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"cmd/server/main.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage main\n\nimport (\n\t\"os\"\n\n\t\"github.com/gofiber/fiber/v2\"\n)\n\nfunc main() {\n\tport := os.Getenv(\"PORT\")\n\tif port == \"\" {\n\t\tport = \"8080\"\n\t}\n\n\t\n\tapp := fiber.New()\n\tapp.Get(\"/health\", func(c *fiber.Ctx) error { return c.JSON(fiber.Map{\"status\": \"ok\", \"architecture\": \"clean\"}) })\n\tapp.Listen(\":\" + port)\n\t\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"db/init/001_init.sql\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nCREATE TABLE IF NOT EXISTS orders (\n  id SERIAL PRIMARY KEY,\n  total DECIMAL(10,2)\n);\nINSERT INTO orders DEFAULT VALUES;\n\n\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"docker-compose.yaml\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nservices:\n  app:\n    build: .\n    ports:\n      - \"8080:8080\"\n    env_file:\n      - ./.env\n    depends_on:\n      postgres:\n        condition: service_healthy\n  postgres:\n    image: postgres:16-alpine\n    environment:\n      POSTGRES_DB: app\n      POSTGRES_USER: app\n      POSTGRES_PASSWORD: app\n    volumes:\n      - ./db/init:/docker-entrypoint-initdb.d\n    ports:\n      - \"5432:5432\"\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U app -d app\"]\n      interval: 5s\n      timeout: 5s\n      retries: 12\n  redis:\n    image: redis:7-alpine\n    ports:\n      - \"6379:6379\"\n  kafka:\n    image: bitnami/kafka:3.9\n    ports:\n      - \"9092:9092\"\n    environment:\n      - KAFKA_CFG_NODE_ID=1\n      - KAFKA_CFG_PROCESS_ROLES=broker,controller\n      - KAFKA_CFG_CONTROLLER_LISTENER_NAMES=CONTROLLER\n      - KAFKA_CFG_LISTENERS=PLAINTEXT://:9092,CONTROLLER://:9093\n      - KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092\n      - KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT\n      - KAFKA_CFG_CONTROLLER_QUORUM_VOTERS=1@kafka:9093\n      - ALLOW_PLAINTEXT_LISTENER=yes\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"docs/openapi.yaml\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nopenapi: 3.0.3\ninfo:\n  title: StackSprint API\n  version: 1.0.0\npaths:\n  /health:\n    get:\n      responses:\n        '200':\n          description: OK\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"go.mod\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nmodule github.com/acme/golden-go-clean\n\ngo 1.23\n\nrequire (\n\tgithub.com/gofiber/fiber/v2 v2.52.6\n\tgorm.io/gorm v1.25.12\n\tgorm.io/driver/postgres v1.5.11\n\tgoogle.golang.org/grpc v1.69.2\n\tgoogle.golang.org/protobuf v1.36.1\n)\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/cache/redis.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage cache\n\nimport \"os\"\n\ntype RedisCache struct {\n\tAddr string\n}\n\nfunc NewRedisCache() *RedisCache {\n\taddr := os.Getenv(\"REDIS_ADDR\")\n\tif addr == \"\" {\n\t\taddr = \"redis:6379\"\n\t}\n\treturn \u0026RedisCache{Addr: addr}\n}\n\nfunc (r *RedisCache) Ping() string {\n\treturn \"redis configured at \" + r.Addr\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/config/config.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage config\n\nimport \"os\"\n\nfunc Port() string {\n\tp := os.Getenv(\"PORT\")\n\tif p == \"\" {\n\t\treturn \"8080\"\n\t}\n\treturn p\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/db/connection.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage db\n\nimport (\n\t\"os\"\n\n\t\"gorm.io/driver/postgres\"\n\t\"gorm.io/gorm\"\n)\n\nfunc Connect() (*gorm.DB, error) {\n\tdsn := os.Getenv(\"DATABASE_URL\")\n\treturn gorm.Open(postgres.Open(dsn), \u0026gorm.Config{})\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/delivery/http/order_handler.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage http\n\nimport (\n\t\"context\"\n\n\t\"github.com/acme/golden-go-clean/internal/domain\"\n\t\"github.com/acme/golden-go-clean/internal/usecase\"\n)\n\ntype OrderHandler struct {\n\tuc *usecase.OrderUsecase\n}\n\nfunc NewOrderHandler(uc *usecase.OrderUsecase) *OrderHandler {\n\treturn \u0026OrderHandler{uc: uc}\n}\n\nfunc (h *OrderHandler) Create(ctx context.Context, entity *domain.Order) error {\n\treturn h.uc.Create(ctx, entity)\n}\n\nfunc (h *OrderHandler) GetByID(ctx context.Context, id int) (*domain.Order, error) {\n\treturn h.uc.GetByID(ctx, id)\n}\n\nfunc (h *OrderHandler) List(ctx context.Context) ([]domain.Order, error) {\n\treturn h.uc.List(ctx)\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/domain/order.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage domain\n\n// Order is generated by StackSprint from the schema builder.\ntype Order struct {\n\tID int `json:\"id\" gorm:\"primaryKey;column:id\"`\n\tTotal float64 `json:\"total\" gorm:\"column:total\"`\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/grpc/client/client.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage client\n\nimport \"fmt\"\n\ntype Client struct{ Address string }\n\nfunc New(address string) *Client {\n\tif address == \"\" {\n\t\taddress = \"127.0.0.1:9090\"\n\t}\n\treturn \u0026Client{Address: address}\n}\n\nfunc (c *Client) Ping() string {\n\treturn fmt.Sprintf(\"ping stub to %s\", c.Address)\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/grpc/server/server.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage server\n\nimport \"context\"\n\ntype PingRequest struct{ Source string }\ntype PingReply struct{ Message string }\n\ntype Service struct{}\n\nfunc (s *Service) Ping(_ context.Context, req *PingRequest) (*PingReply, error) {\n\treturn \u0026PingReply{Message: \"pong from \" + req.Source}, nil\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/handlers/item_handler_test.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage handlers\n\nimport \"testing\"\n\nfunc TestPlaceholder(t *testing.T) {\n\tif false {\n\t\tt.Fatal(\"expected true\")\n\t}\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/handlers/items.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage handlers\n\nimport \"github.com/gofiber/fiber/v2\"\n\nfunc ListItems(c *fiber.Ctx) error {\n\treturn c.JSON([]map[string]any{{\"id\": 1, \"name\": \"sample\"}})\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/health/handler.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage health\n\nfunc Message() string { return \"ok\" }\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/logger/logger.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage logger\n\nimport \"log\"\n\nfunc Info(msg string) { log.Println(\"INFO:\", msg) }\nfunc Error(msg string) { log.Println(\"ERROR:\", msg) }\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/messaging/kafka_consumer.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage messaging\n\nimport \"os\"\n\ntype KafkaConsumer struct {\n\tBrokers string\n}\n\nfunc NewKafkaConsumer() *KafkaConsumer {\n\tb := os.Getenv(\"KAFKA_BROKERS\")\n\tif b == \"\" {\n\t\tb = \"kafka:9092\"\n\t}\n\treturn \u0026KafkaConsumer{Brokers: b}\n}\n\nfunc (c *KafkaConsumer) Subscribe(topic string) string {\n\treturn \"consumer stub subscribed to \" + topic + \" via \" + c.Brokers\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/messaging/kafka_producer.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage messaging\n\nimport \"os\"\n\ntype KafkaProducer struct {\n\tBrokers string\n}\n\nfunc NewKafkaProducer() *KafkaProducer {\n\tb := os.Getenv(\"KAFKA_BROKERS\")\n\tif b == \"\" {\n\t\tb = \"kafka:9092\"\n\t}\n\treturn \u0026KafkaProducer{Brokers: b}\n}\n\nfunc (p *KafkaProducer) Publish(topic, payload string) string {\n\treturn \"publish stub to \" + topic + \" via \" + p.Brokers + \" payload=\" + payload\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/middleware/error.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage middleware\n\nimport \"github.com/gofiber/fiber/v2\"\n\nfunc ErrorHandler(c *fiber.Ctx, err error) error {\n\treturn c.Status(500).JSON(fiber.Map{\"error\": err.Error()})\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/models/models.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage models\n\ntype Order struct {\n\tId int `json:\"id\" gorm:\"column:id\"`\n\tTotal float64 `json:\"total\" gorm:\"column:total\"`\n}\n\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/repository/order_repository.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage repository\n\nimport (\n\t\"context\"\n\n\t\"gorm.io/gorm\"\n\n\n\t\"github.com/acme/golden-go-clean/internal/domain\"\n)\n\ntype OrderRepository struct {\n\n\tdb *gorm.DB\n\n}\n\n\nfunc NewOrderRepository(db *gorm.DB) *OrderRepository {\n\treturn \u0026OrderRepository{db: db}\n}\n\n\nfunc (r *OrderRepository) Create(ctx context.Context, entity *domain.Order) error {\n\n\treturn r.db.WithContext(ctx).Create(entity).Error\n\n}\n\nfunc (r *OrderRepository) GetByID(ctx context.Context, id int) (*domain.Order, error) {\n\n\tout := \u0026domain.Order{}\n\tif err := r.db.WithContext(ctx).First(out, id).Error; err != nil {\n\t\treturn nil, err\n\t}\n\treturn out, nil\n\n}\n\nfunc (r *OrderRepository) List(ctx context.Context) ([]domain.Order, error) {\n\n\tout := make([]domain.Order, 0)\n\tif err := r.db.WithContext(ctx).Find(\u0026out).Error; err != nil {\n\t\treturn nil, err\n\t}\n\treturn out, nil\n\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/routes/base.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage routes\n\nconst BasePath = \"/api/v1\"\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"internal/usecase/order_usecase.go\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\npackage usecase\n\nimport (\n\t\"context\"\n\n\t\"github.com/acme/golden-go-clean/internal/domain\"\n)\n\ntype OrderRepository interface {\n\tCreate(ctx context.Context, entity *domain.Order) error\n\tGetByID(ctx context.Context, id int) (*domain.Order, error)\n\tList(ctx context.Context) ([]domain.Order, error)\n}\n\ntype OrderUsecase struct {\n\trepo OrderRepository\n}\n\nfunc NewOrderUsecase(repo OrderRepository) *OrderUsecase {\n\treturn \u0026OrderUsecase{repo: repo}\n}\n\nfunc (u *OrderUsecase) Create(ctx context.Context, entity *domain.Order) error {\n\treturn u.repo.Create(ctx, entity)\n}\n\nfunc (u *OrderUsecase) GetByID(ctx context.Context, id int) (*domain.Order, error) {\n\treturn u.repo.GetByID(ctx, id)\n}\n\nfunc (u *OrderUsecase) List(ctx context.Context) ([]domain.Order, error) {\n\treturn u.repo.List(ctx)\n}\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"migrations/001_initial.sql\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nCREATE TABLE IF NOT EXISTS orders (\n  id SERIAL PRIMARY KEY,\n  total DECIMAL(10,2)\n);\n\n\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"proto/README.md\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\n# Shared proto definitions\n\nPlace your protobuf contracts here.\nEOF_STACKSPRINT_GEN_9942\n\ncat \u003e \"proto/common.proto\" \u003c\u003c'EOF_STACKSPRINT_GEN_9942'\nsyntax = \"proto3\";\npackage stacksprint;\n\nservice InternalService {\n  rpc Ping(PingRequest) returns (PingReply);\n}\n\nmessage PingRequest {\n  string source = 1;\n}\n\nmessage PingReply {\n  string message = 1;\n}\nEOF_STACKSPRINT_GEN_9942\n\necho \"StackSprint project generated successfully.\"\necho \"Run: docker compose up --build\"\n",
  "powershell_script": "$ErrorActionPreference = 'Stop'\n\n$RootDir = 'golden-go-clean'\nNew-Item -ItemType Directory -Path $RootDir -Force | Out-Null\nSet-Location $RootDir\n\ngit init\ngo mod init 'github.com/acme/golden-go-clean'\nNew-Item -ItemType Directory -Path '.github' -Force | Out-Null\nNew-Item -ItemType Directory -Path '.github/workflows' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'cmd' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'cmd/server' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'db' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'db/init' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'docs' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/cache' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/config' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/db' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/delivery' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/delivery/http' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/domain' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/grpc' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/grpc/client' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/grpc/server' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/handlers' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/health' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/logger' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/messaging' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/middleware' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/models' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/repository' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/routes' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'internal/usecase' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'migrations' -Force | Out-Null\nNew-Item -ItemType Directory -Path 'proto' -Force | Out-Null\n\n@'\nPORT=8080\nDATABASE_URL=postgres://app:app@postgres:5432/app?sslmode=disable\nREDIS_ADDR=redis:6379\nKAFKA_BROKERS=kafka:9092\n'@ | Set-Content -NoNewline '.env'\n\n@'\nname: CI\n\non:\n  push:\n  pull_request:\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        if: hashFiles('package.json') != ''\n        with:\n          node-version: '22'\n      - uses: actions/setup-go@v5\n        if: hashFiles('go.mod') != ''\n        with:\n          go-version: '1.23'\n      - uses: actions/setup-python@v5\n        if: hashFiles('requirements.txt') != ''\n        with:\n          python-version: '3.12'\n      - run: go test ./...\n        if: hashFiles('go.mod') != ''\n      - run: npm test\n        if: hashFiles('package.json') != ''\n      - run: pytest\n        if: hashFiles('requirements.txt') != ''\n'@ | Set-Content -NoNewline '.github/workflows/ci.yaml'\n\n@'\n# StackSprint\n.env\n*.log\n.DS_Store\nbin/\ncoverage.out\n'@ | Set-Content -NoNewline '.gitignore'\n\n@'\nFROM golang:1.23-alpine AS build\nWORKDIR /app\nCOPY . .\nRUN go mod tidy \u0026\u0026 go build -o app ./cmd/server\n\nFROM alpine:3.21\nWORKDIR /app\nCOPY --from=build /app/app ./app\nEXPOSE 8080\nCMD [\"./app\"]\n'@ | Set-Content -NoNewline 'Dockerfile'\n\n@'\nup:\n\tdocker compose up --build\n\ndown:\n\tdocker compose down -v\n\ntest:\n\t@echo \"Run language-specific tests\"\n'@ | Set-Content -NoNewline 'Makefile'\n\n@'\n# StackSprint Generated Project\n\nLanguage: go\nFramework: fiber\nArchitecture: clean\nDatabase: postgresql\n\n## Run\n\n```bash\ndocker compose up --build\n```\n'@ | Set-Content -NoNewline 'README.md'\n\n@'\npackage main\n\nimport (\n\t\"os\"\n\n\t\"github.com/gofiber/fiber/v2\"\n)\n\nfunc main() {\n\tport := os.Getenv(\"PORT\")\n\tif port == \"\" {\n\t\tport = \"8080\"\n\t}\n\n\t\n\tapp := fiber.New()\n\tapp.Get(\"/health\", func(c *fiber.Ctx) error { return c.JSON(fiber.Map{\"status\": \"ok\", \"architecture\": \"clean\"}) })\n\tapp.Listen(\":\" + port)\n\t\n}\n'@ | Set-Content -NoNewline 'cmd/server/main.go'\n\n@'\nCREATE TABLE IF NOT EXISTS orders (\n  id SERIAL PRIMARY KEY,\n  total DECIMAL(10,2)\n);\nINSERT INTO orders DEFAULT VALUES;\n\n\n'@ | Set-Content -NoNewline 'db/init/001_init.sql'\n\n@'\nservices:\n  app:\n    build: .\n    ports:\n      - \"8080:8080\"\n    env_file:\n      - ./.env\n    depends_on:\n      postgres:\n        condition: service_healthy\n  postgres:\n    image: postgres:16-alpine\n    environment:\n      POSTGRES_DB: app\n      POSTGRES_USER: app\n      POSTGRES_PASSWORD: app\n    volumes:\n      - ./db/init:/docker-entrypoint-initdb.d\n    ports:\n      - \"5432:5432\"\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U app -d app\"]\n      interval: 5s\n      timeout: 5s\n      retries: 12\n  redis:\n    image: redis:7-alpine\n    ports:\n      - \"6379:6379\"\n  kafka:\n    image: bitnami/kafka:3.9\n    ports:\n      - \"9092:9092\"\n    environment:\n      - KAFKA_CFG_NODE_ID=1\n      - KAFKA_CFG_PROCESS_ROLES=broker,controller\n      - KAFKA_CFG_CONTROLLER_LISTENER_NAMES=CONTROLLER\n      - KAFKA_CFG_LISTENERS=PLAINTEXT://:9092,CONTROLLER://:9093\n      - KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092\n      - KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT\n      - KAFKA_CFG_CONTROLLER_QUORUM_VOTERS=1@kafka:9093\n      - ALLOW_PLAINTEXT_LISTENER=yes\n'@ | Set-Content -NoNewline 'docker-compose.yaml'\n\n@'\nopenapi: 3.0.3\ninfo:\n  title: StackSprint API\n  version: 1.0.0\npaths:\n  /health:\n    get:\n      responses:\n        '200':\n          description: OK\n'@ | Set-Content -NoNewline 'docs/openapi.yaml'\n\n@'\nmodule github.com/acme/golden-go-clean\n\ngo 1.23\n\nrequire (\n\tgithub.com/gofiber/fiber/v2 v2.52.6\n\tgorm.io/gorm v1.25.12\n\tgorm.io/driver/postgres v1.5.11\n\tgoogle.golang.org/grpc v1.69.2\n\tgoogle.golang.org/protobuf v1.36.1\n)\n'@ | Set-Content -NoNewline 'go.mod'\n\n@'\npackage cache\n\nimport \"os\"\n\ntype RedisCache struct {\n\tAddr string\n}\n\nfunc NewRedisCache() *RedisCache {\n\taddr := os.Getenv(\"REDIS_ADDR\")\n\tif addr == \"\" {\n\t\taddr = \"redis:6379\"\n\t}\n\treturn \u0026RedisCache{Addr: addr}\n}\n\nfunc (r *RedisCache) Ping() string {\n\treturn \"redis configured at \" + r.Addr\n}\n'@ | Set-Content -NoNewline 'internal/cache/redis.go'\n\n@'\npackage config\n\nimport \"os\"\n\nfunc Port() string {\n\tp := os.Getenv(\"PORT\")\n\tif p == \"\" {\n\t\treturn \"8080\"\n\t}\n\treturn p\n}\n'@ | Set-Content -NoNewline 'internal/config/config.go'\n\n@'\npackage db\n\nimport (\n\t\"os\"\n\n\t\"gorm.io/driver/postgres\"\n\t\"gorm.io/gorm\"\n)\n\nfunc Connect() (*gorm.DB, error) {\n\tdsn := os.Getenv(\"DATABASE_URL\")\n\treturn gorm.Open(postgres.Open(dsn), \u0026gorm.Config{})\n}\n'@ | Set-Content -NoNewline 'internal/db/connection.go'\n\n@'\npackage http\n\nimport (\n\t\"context\"\n\n\t\"github.com/acme/golden-go-clean/internal/domain\"\n\t\"github.com/acme/golden-go-clean/internal/usecase\"\n)\n\ntype OrderHandler struct {\n\tuc *usecase.OrderUsecase\n}\n\nfunc NewOrderHandler(uc *usecase.OrderUsecase) *OrderHandler {\n\treturn \u0026OrderHandler{uc: uc}\n}\n\nfunc (h *OrderHandler) Create(ctx context.Context, entity *domain.Order) error {\n\treturn h.uc.Create(ctx, entity)\n}\n\nfunc (h *OrderHandler) GetByID(ctx context.Context, id int) (*domain.Order, error) {\n\treturn h.uc.GetByID(ctx, id)\n}\n\nfunc (h *OrderHandler) List(ctx context.Context) ([]domain.Order, error) {\n\treturn h.uc.List(ctx)\n}\n'@ | Set-Content -NoNewline 'internal/delivery/http/order_handler.go'\n\n@'\npackage domain\n\n// Order is generated by StackSprint from the schema builder.\ntype Order struct {\n\tID int `json:\"id\" gorm:\"primaryKey;column:id\"`\n\tTotal float64 `json:\"total\" gorm:\"column:total\"`\n}\n'@ | Set-Content -NoNewline 'internal/domain/order.go'\n\n@'\npackage client\n\nimport \"fmt\"\n\ntype Client struct{ Address string }\n\nfunc New(address string) *Client {\n\tif address == \"\" {\n\t\taddress = \"127.0.0.1:9090\"\n\t}\n\treturn \u0026Client{Address: address}\n}\n\nfunc (c *Client) Ping() string {\n\treturn fmt.Sprintf(\"ping stub to %s\", c.Address)\n}\n'@ | Set-Content -NoNewline 'internal/grpc/client/client.go'\n\n@'\npackage server\n\nimport \"context\"\n\ntype PingRequest struct{ Source string }\ntype PingReply struct{ Message string }\n\ntype Service struct{}\n\nfunc (s *Service) Ping(_ context.Context, req *PingRequest) (*PingReply, error) {\n\treturn \u0026PingReply{Message: \"pong from \" + req.Source}, nil\n}\n'@ | Set-Content -NoNewline 'internal/grpc/server/server.go'\n\n@'\npackage handlers\n\nimport \"testing\"\n\nfunc TestPlaceholder(t *testing.T) {\n\tif false {\n\t\tt.Fatal(\"expected true\")\n\t}\n}\n'@ | Set-Content -NoNewline 'internal/handlers/item_handler_test.go'\n\n@'\npackage handlers\n\nimport \"github.com/gofiber/fiber/v2\"\n\nfunc ListItems(c *fiber.Ctx) error {\n\treturn c.JSON([]map[string]any{{\"id\": 1, \"name\": \"sample\"}})\n}\n'@ | Set-Content -NoNewline 'internal/handlers/items.go'\n\n@'\npackage health\n\nfunc Message() string { return \"ok\" }\n'@ | Set-Content -NoNewline 'internal/health/handler.go'\n\n@'\npackage logger\n\nimport \"log\"\n\nfunc Info(msg string) { log.Println(\"INFO:\", msg) }\nfunc Error(msg string) { log.Println(\"ERROR:\", msg) }\n'@ | Set-Content -NoNewline 'internal/logger/logger.go'\n\n@'\npackage messaging\n\nimport \"os\"\n\ntype KafkaConsumer struct {\n\tBrokers string\n}\n\nfunc NewKafkaConsumer() *KafkaConsumer {\n\tb := os.Getenv(\"KAFKA_BROKERS\")\n\tif b == \"\" {\n\t\tb = \"kafka:9092\"\n\t}\n\treturn \u0026KafkaConsumer{Brokers: b}\n}\n\nfunc (c *KafkaConsumer) Subscribe(topic string) string {\n\treturn \"consumer stub subscribed to \" + topic + \" via \" + c.Brokers\n}\n'@ | Set-Content -NoNewline 'internal/messaging/kafka_consumer.go'\n\n@'\npackage messaging\n\nimport \"os\"\n\ntype KafkaProducer struct {\n\tBrokers string\n}\n\nfunc NewKafkaProducer() *KafkaProducer {\n\tb := os.Getenv(\"KAFKA_BROKERS\")\n\tif b == \"\" {\n\t\tb = \"kafka:9092\"\n\t}\n\treturn \u0026KafkaProducer{Brokers: b}\n}\n\nfunc (p *KafkaProducer) Publish(topic, payload string) string {\n\treturn \"publish stub to \" + topic + \" via \" + p.Brokers + \" payload=\" + payload\n}\n'@ | Set-Content -NoNewline 'internal/messaging/kafka_producer.go'\n\n@'\npackage middleware\n\nimport \"github.com/gofiber/fiber/v2\"\n\nfunc ErrorHandler(c *fiber.Ctx, err error) error {\n\treturn c.Status(500).JSON(fiber.Map{\"error\": err.Error()})\n}\n'@ | Set-Content -NoNewline 'internal/middleware/error.go'\n\n@'\npackage models\n\ntype Order struct {\n\tId int `json:\"id\" gorm:\"column:id\"`\n\tTotal float64 `json:\"total\" gorm:\"column:total\"`\n}\n\n'@ | Set-Content -NoNewline 'internal/models/models.go'\n\n@'\npackage repository\n\nimport (\n\t\"context\"\n\n\t\"gorm.io/gorm\"\n\n\n\t\"github.com/acme/golden-go-clean/internal/domain\"\n)\n\ntype OrderRepository struct {\n\n\tdb *gorm.DB\n\n}\n\n\nfunc NewOrderRepository(db *gorm.DB) *OrderRepository {\n\treturn \u0026OrderRepository{db: db}\n}\n\n\nfunc (r *OrderRepository) Create(ctx context.Context, entity *domain.Order) error {\n\n\treturn r.db.WithContext(ctx).Create(entity).Error\n\n}\n\nfunc (r *OrderRepository) GetByID(ctx context.Context, id int) (*domain.Order, error) {\n\n\tout := \u0026domain.Order{}\n\tif err := r.db.WithContext(ctx).First(out, id).Error; err != nil {\n\t\treturn nil, err\n\t}\n\treturn out, nil\n\n}\n\nfunc (r *OrderRepository) List(ctx context.Context) ([]domain.Order, error) {\n\n\tout := make([]domain.Order, 0)\n\tif err := r.db.WithContext(ctx).Find(\u0026out).Error; err != nil {\n\t\treturn nil, err\n\t}\n\treturn out, nil\n\n}\n'@ | Set-Content -NoNewline 'internal/repository/order_repository.go'\n\n@'\npackage routes\n\nconst BasePath = \"/api/v1\"\n'@ | Set-Content -NoNewline 'internal/routes/base.go'\n\n@'\npackage usecase\n\nimport (\n\t\"context\"\n\n\t\"github.com/acme/golden-go-clean/internal/domain\"\n)\n\ntype OrderRepository interface {\n\tCreate(ctx context.Context, entity *domain.Order) error\n\tGetByID(ctx context.Context, id int) (*domain.Order, error)\n\tList(ctx context.Context) ([]domain.Order, error)\n}\n\ntype OrderUsecase struct {\n\trepo OrderRepository\n}\n\nfunc NewOrderUsecase(repo OrderRepository) *OrderUsecase {\n\treturn \u0026OrderUsecase{repo: repo}\n}\n\nfunc (u *OrderUsecase) Create(ctx context.Context, entity *domain.Order) error {\n\treturn u.repo.Create(ctx, entity)\n}\n\nfunc (u *OrderUsecase) GetByID(ctx context.Context, id int) (*domain.Order, error) {\n\treturn u.repo.GetByID(ctx, id)\n}\n\nfunc (u *OrderUsecase) List(ctx context.Context) ([]domain.Order, error) {\n\treturn u.repo.List(ctx)\n}\n'@ | Set-Content -NoNewline 'internal/usecase/order_usecase.go'\n\n@'\nCREATE TABLE IF NOT EXISTS orders (\n  id SERIAL PRIMARY KEY,\n  total DECIMAL(10,2)\n);\n\n\n'@ | Set-Content -NoNewline 'migrations/001_initial.sql'\n\n@'\n# Shared proto definitions\n\nPlace your protobuf contracts here.\n'@ | Set-Content -NoNewline 'proto/README.md'\n\n@'\nsyntax = \"proto3\";\npackage stacksprint;\n\nservice InternalService {\n  rpc Ping(PingRequest) returns (PingReply);\n}\n\nmessage PingRequest {\n  string source = 1;\n}\n\nmessage PingReply {\n  string message = 1;\n}\n'@ | Set-Content -NoNewline 'proto/common.proto'\n\nWrite-Host 'StackSprint project generated successfully.'\nWrite-Host 'Run: docker compose up --build'\n",
  "file_paths": [
    ".env",
    ".github",
    ".github/workflows",
    ".github/workflows/ci.yaml",
    ".gitignore",
    "Dockerfile",
    "Makefile",
    "README.md",
    "cmd",
    "cmd/server",
    "cmd/server/main.go",
    "db",
    "db/init",
    "db/init/001_init.sql",
    "docker-compose.yaml",
    "docs",
    "docs/openapi.yaml",
    "go.mod",
    "internal",
    "internal/cache",
    "internal/cache/redis.go",
    "internal/config",
    "internal/config/config.go",
    "internal/db",
    "internal/db/connection.go",
    "internal/delivery",
    "internal/delivery/http",
    "internal/delivery/http/order_handler.go",
    "internal/domain",
    "internal/domain/order.go",
    "internal/grpc",
    "internal/grpc/client",
    "internal/grpc/client/client.go",
    "internal/grpc/server",
    "internal/grpc/server/server.go",
    "internal/handlers",
    "internal/handlers/item_handler_test.go",
    "internal/handlers/items.go",
    "internal/health",
    "internal/health/handler.go",
    "internal/logger",
    "internal/logger/logger.go",
    "internal/messaging",
    "internal/messaging/kafka_consumer.go",
    "internal/messaging/kafka_producer.go",
    "internal/middleware",
    "internal/middleware/error.go",
    "internal/models",
    "internal/models/models.go",
    "internal/repository",
    "internal/repository/order_repository.go",
    "internal/routes",
    "internal/routes/base.go",
    "internal/usecase",
    "internal/usecase/order_usecase.go",
    "migrations",
    "migrations/001_initial.sql",
    "proto",
    "proto/README.md",
    "proto/common.proto"
  ],
  "warnings": [],
  "decisions": [
    {
      "code": "stack.core",
      "category": "stack",
      "message": "Language=go, Framework=fiber, Architecture=clean."
    },
    {
      "code": "arch.monolith",
      "category": "architecture",
      "message": "Generated a single-service project structure."
    },
    {
      "code": "db.selected",
      "category": "database",
      "message": "Database=postgresql with ORM enabled."
    },
    {
      "code": "infra.enabled",
      "category": "infra",
      "message": "Enabled infra: kafka, redis."
    },
    {
      "code": "features.enabled",
      "category": "features",
      "message": "Enabled features: github_actions_ci, global_error_handler, health_endpoint, logger, makefile, sample_test, swagger."
    },
    {
      "code": "output.compose",
      "category": "output",
      "message": "docker-compose.yaml included."
    },
    {
      "code": "output.dockerfile",
      "category": "output",
      "message": "Dockerfile boilerplate included."
    },
    {
      "code": "output.readme",
      "category": "output",
      "message": "README.md included."
    },
    {
      "code": "output.tree",
      "category": "output",
      "message": "Generated 32 files and 28 directories."
    }
  ]
}
